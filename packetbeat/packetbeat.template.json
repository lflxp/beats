{
  "mappings": {
    "_default_": {
      "_meta": {
        "version": "5.6.4"
      },
      "date_detection": false,
      "dynamic_templates": [
        {
          "strings_as_keyword": {
            "mapping": {
              "ignore_above": 1024,
              "type": "keyword"
            },
            "match_mapping_type": "string"
          }
        }
      ],
      "properties": {
        "@timestamp": {
          "type": "date"
        },
        "beat": {
          "properties": {
            "hostname": {
              "ignore_above": 1024,
              "type": "keyword"
            },
            "name": {
              "ignore_above": 1024,
              "type": "keyword"
            },
            "version": {
              "ignore_above": 1024,
              "type": "keyword"
            }
          }
        },
        "bytes_in": {
          "type": "long"
        },
        "bytes_out": {
          "type": "long"
        },
        "client_geoip": {
          "properties": {
            "location": {
              "type": "geo_point"
            }
          }
        },
        "client_ip": {
          "ignore_above": 1024,
          "type": "keyword"
        },
        "client_location": {
          "type": "geo_point"
        },
        "client_port": {
          "ignore_above": 1024,
          "type": "keyword"
        },
        "client_proc": {
          "ignore_above": 1024,
          "type": "keyword"
        },
        "client_server": {
          "ignore_above": 1024,
          "type": "keyword"
        },
        "client_service": {
          "ignore_above": 1024,
          "type": "keyword"
        },
        "connection_id": {
          "ignore_above": 1024,
          "type": "keyword"
        },
        "connecttime": {
          "type": "long"
        },
        "cpu_time": {
          "type": "long"
        },
        "dest": {
          "properties": {
            "ip": {
              "ignore_above": 1024,
              "type": "keyword"
            },
            "ip_location": {
              "type": "geo_point"
            },
            "ipv6": {
              "ignore_above": 1024,
              "type": "keyword"
            },
            "ipv6_location": {
              "type": "geo_point"
            },
            "mac": {
              "ignore_above": 1024,
              "type": "keyword"
            },
            "outer_ip": {
              "ignore_above": 1024,
              "type": "keyword"
            },
            "outer_ip_location": {
              "type": "geo_point"
            },
            "outer_ipv6": {
              "ignore_above": 1024,
              "type": "keyword"
            },
            "outer_ipv6_location": {
              "type": "geo_point"
            },
            "port": {
              "ignore_above": 1024,
              "type": "keyword"
            },
            "stats": {
              "properties": {
                "net_bytes_total": {
                  "type": "long"
                },
                "net_packets_total": {
                  "type": "long"
                }
              }
            }
          }
        },
        "direction": {
          "ignore_above": 1024,
          "type": "keyword"
        },
        "dnstime": {
          "type": "long"
        },
        "domloadtime": {
          "type": "long"
        },
        "final": {
          "ignore_above": 1024,
          "type": "keyword"
        },
        "flow_id": {
          "ignore_above": 1024,
          "type": "keyword"
        },
        "sflow": {
          "properties": {
            "Datagram": {
                "properties": {
                    "IPLength": {
                        "ignore_above": 1024,
                        "type": "keyword"
                    },
                    "SrcIP": {
                        "ignore_above": 1024,
                        "type": "keyword"
                    },
                    "DstIP": {
                        "ignore_above": 1024,
                        "type": "keyword"
                    },
                    "SrcPort": {
                        "type": "long"
                    },
                    "DstPort": {
                        "type": "long"
                    }
                }
            },
            "DatagramVersion": {
               "ignore_above": 1024,
               "type": "keyword"
             },
            "AgentAddress": {
               "ignore_above": 1024,
               "type": "keyword"
             },
            "SubAgentID": {
               "ignore_above": 1024,
               "type": "keyword"
             },
            "SequenceNumber": {
               "type": "long"
             },
            "AgentUptime": {
               "type": "long"
             },
            "SampleCount": {
               "type": "long"
             },
            "EnterpriseID": {
               "type": "long"
             },
            "Format": {
               "ignore_above": 1024,
               "type": "keyword"
             },
            "SourceIDClass": {
               "type": "long"
             },
            "SourceIDIndex": {
               "type": "long"
             },
            "SourceIDIndexName": {
              "type": "keyword"
             },
            "SamplingRate": {
               "type": "long"
             },
            "SamplePool": {
               "type": "long"
             },
            "Dropped": {
               "type": "long"
             },
            "InputInterfaceFormat": {
               "ignore_above": 1024,
               "type": "keyword"
             },
            "InputInterface": {
               "type": "long"
             },
             "InputInterfaceName": {
                "type": "keyword"
             },
            "OutputInterfaceFormat": {
               "ignore_above": 1024,
               "type": "keyword"
             },
            "OutputInterface": {
               "type": "long"
             },
            "OutputInterfaceName": {
               "type": "keyword"
             },
            "RecordCount": {
               "type": "long"
             },
            "SampleLength": {
               "type": "long"
             },

            "SFlowRawPacketFlowRecord": {
              "properties": {
                "SFlowBaseFlowRecord": {
                  "properties": {
                    "EnterpriseID": {
                      "ignore_above": 1024,
                      "type": "keyword"
                    },
                    "Format": {
                      "ignore_above": 1024,
                      "type": "keyword"
                    },
                    "FlowDataLength": {
                      "type": "long"
                    }
                  }
                },
                "Header": {
                  "properties": {
                    "FlowRecords": {
                      "type": "long"
                    },
                    "Packets": {
                      "type": "long"
                    },
                    "Bytes": {
                      "type": "long"
                    },
                    "RateBytes": {
                      "type": "long"
                    },
                    "SrcMac": {
                      "ignore_above": 1024,
                      "type": "keyword"
                    },
                    "DstMac": {
                      "ignore_above": 1024,
                      "type": "keyword"
                    },
                    "SrcIP": {
                      "ignore_above": 1024,
                      "type": "keyword"
                    },
                    "DstIP": {
                      "ignore_above": 1024,
                      "type": "keyword"
                    },
                    "Ipv4_version": {
                      "type": "long"
                    },
                    "Ipv4_ihl": {
                      "type": "long"
                    },
                    "Ipv4_tos": {
                      "type": "long"
                    },
                    "Ipv4_ttl": {
                      "type": "long"
                    },
                    "Ipv4_protocol": {
                      "ignore_above": 1024,
                      "type": "keyword"
                    },
                    "SrcPort": {
                      "type": "long"
                    },
                    "DstPort": {
                      "type": "long"
                    }
                  }
                },
                "HeaderProtocol": {
                  "ignore_above": 1024,
                  "type": "keyword"
                },
                "FrameLength": {
                  "type": "long"
                },
                "PayloadRemoved": {
                  "type": "long"
                },
                "HeaderLength": {
                  "type": "long"
                }
              }
            },
            "SFlowExtendedSwitchFlowRecord": {
              "properties": {
                "SFlowBaseFlowRecord": {
                  "properties": {
                    "EnterpriseID": {
                      "ignore_above": 1024,
                      "type": "keyword"
                    },
                    "Format": {
                      "ignore_above": 1024,
                      "type": "keyword"
                    },
                    "FlowDataLength": {
                      "type": "long"
                    }
                  }
                },
                "IncomingVLAN": {
                  "type": "long"
                },
                "IncomingVLANPriority": {
                  "type": "long"
                },
                "OutgoingVLAN": {
                  "type": "long"
                },
                "OutgoingVLAN": {
                  "type": "long"
                }
              }
            },
            "SFlowExtendedRouterFlowRecord": {
              "properties": {
                "SFlowBaseFlowRecord": {
                  "properties": {
                    "EnterpriseID": {
                      "ignore_above": 1024,
                      "type": "keyword"
                    },
                    "Format": {
                      "ignore_above": 1024,
                      "type": "keyword"
                    },
                    "FlowDataLength": {
                      "type": "long"
                    }
                  }
                },
                "NextHop": {
                  "ignore_above": 1024,
                  "type": "keyword"
                },
                "NextHopSourceMask": {
                  "ignore_above": 1024,
                  "type": "keyword"
                },
                "NextHopDestinationMask": {
                  "ignore_above": 1024,
                  "type": "keyword"
                }
              }
            },
            "SFlowExtendedGatewayFlowRecord": {
              "properties": {
                "SFlowBaseFlowRecord": {
                  "properties": {
                    "EnterpriseID": {
                      "ignore_above": 1024,
                      "type": "keyword"
                    },
                    "Format": {
                      "ignore_above": 1024,
                      "type": "keyword"
                    },
                    "FlowDataLength": {
                      "type": "long"
                    }
                  }
                },
                "NextHop": {
                  "ignore_above": 1024,
                  "type": "keyword"
                },
                "AS": {
                  "type": "long"
                },
                "SourceAS": {
                  "type": "long"
                },
                "PeerAS": {
                  "type": "long"
                },
                "ASPathCount": {
                  "type": "long"
                },
                "ASPath": {
                  "ignore_above": 1024,
                  "type": "keyword"
                },
                "Communities": {
                  "ignore_above": 1024,
                  "type": "keyword"
                },
                "LocalPref": {
                  "type": "long"
                }
              }
            },
            "SFlowExtendedUserFlow": {
              "properties": {
                "SFlowBaseFlowRecord": {
                  "properties": {
                    "EnterpriseID": {
                      "ignore_above": 1024,
                      "type": "keyword"
                    },
                    "Format": {
                      "ignore_above": 1024,
                      "type": "keyword"
                    },
                    "FlowDataLength": {
                      "type": "long"
                    }
                  }
                },
                "SourceCharSet": {
                  "ignore_above": 1024,
                  "type": "keyword"
                },
                "SourceUserID": {
                  "ignore_above": 1024,
                  "type": "keyword"
                },
                "DestinationCharSet": {
                  "ignore_above": 1024,
                  "type": "keyword"
                },
                "DestinationUserID": {
                  "ignore_above": 1024,
                  "type": "keyword"
                }
              }
            },
            "SFlowGenericInterfaceCounters": {
              "properties": {
                "SFlowBaseFlowRecord": {
                  "properties": {
                    "EnterpriseID": {
                      "ignore_above": 1024,
                      "type": "keyword"
                    },
                    "Format": {
                      "ignore_above": 1024,
                      "type": "keyword"
                    },
                    "FlowDataLength": {
                      "type": "long"
                    }
                  }
                },
                "IfIndex": {
                  "type": "long"
                },
                "IfType": {
                  "type": "long"
                },
                "IfSpeed": {
                  "type": "long"
                },
                "IfDirection": {
                  "type": "long"
                },
                "IfStatus": {
                  "type": "long"
                },
                "IfInOctets": {
                  "type": "long"
                },
                "IfInUcastPkts": {
                  "type": "long"
                },
                "IfInMulticastPkts": {
                  "type": "long"
                },
                "IfInBroadcastPkts": {
                  "type": "long"
                },
                "IfInDiscards": {
                  "type": "long"
                },
                "IfInErrors": {
                  "type": "long"
                },
                "IfInUnknownProtos": {
                  "type": "long"
                },
                "IfOutOctets": {
                  "type": "long"
                },
                "IfOutUcastPkts": {
                  "type": "long"
                },
                "IfOutMulticastPkts": {
                  "type": "long"
                },
                "IfOutDiscards": {
                  "type": "long"
                },
                "IfOutErrors": {
                  "type": "long"
                },
                "IfPromiscuousMode": {
                  "type": "long"
                }
              }
            },
            "SFlowEthernetCounters": {
              "properties": {
                "SFlowBaseFlowRecord": {
                  "properties": {
                    "EnterpriseID": {
                      "ignore_above": 1024,
                      "type": "keyword"
                    },
                    "Format": {
                      "ignore_above": 1024,
                      "type": "keyword"
                    },
                    "FlowDataLength": {
                      "type": "long"
                    }
                  }
                },
                "AlignmentErrors": {
                  "type": "long"
                },
                "FCSErrors": {
                  "type": "long"
                },
                "SingleCollisionFrames": {
                  "type": "long"
                },
                "MultipleCollisionFrames": {
                  "type": "long"
                },
                "SQETestErrors": {
                  "type": "long"
                },
                "DeferredTransmissions": {
                  "type": "long"
                },
                "LateCollisions": {
                  "type": "long"
                },
                "ExcessiveCollisions": {
                  "type": "long"
                },
                "InternalMacTransmitErrors": {
                  "type": "long"
                },
                "CarrierSenseErrors": {
                  "type": "long"
                },
                "FrameTooLongs": {
                  "type": "long"
                },
                "InternalMacReceiveErrors": {
                  "type": "long"
                },
                "SymbolErrors": {
                  "type": "long"
                }
              }
            },
            "SFlowProcessorCounters": {
              "properties": {
                "SFlowBaseFlowRecord": {
                  "properties": {
                    "EnterpriseID": {
                      "ignore_above": 1024,
                      "type": "keyword"
                    },
                    "Format": {
                      "ignore_above": 1024,
                      "type": "keyword"
                    },
                    "FlowDataLength": {
                      "type": "long"
                    }
                  }
                },
                "FiveSecCpu": {
                  "type": "long"
                },
                "OneMinCpu": {
                  "type": "long"
                },
                "FiveMinCpu": {
                  "type": "long"
                },
                "TotalMemory": {
                  "type": "long"
                },
                "FreeMemory": {
                  "type": "long"
                }
              }
            }
          }
        },
        "ip": {
          "ignore_above": 1024,
          "type": "keyword"
        },
        "last_time": {
          "type": "date"
        },
        "loadtime": {
          "type": "long"
        },
        "meta": {
          "properties": {
            "cloud": {
              "properties": {
                "availability_zone": {
                  "ignore_above": 1024,
                  "type": "keyword"
                },
                "instance_id": {
                  "ignore_above": 1024,
                  "type": "keyword"
                },
                "machine_type": {
                  "ignore_above": 1024,
                  "type": "keyword"
                },
                "project_id": {
                  "ignore_above": 1024,
                  "type": "keyword"
                },
                "provider": {
                  "ignore_above": 1024,
                  "type": "keyword"
                },
                "region": {
                  "ignore_above": 1024,
                  "type": "keyword"
                }
              }
            }
          }
        },
        "method": {
          "ignore_above": 1024,
          "type": "keyword"
        },
        "notes": {
          "ignore_above": 1024,
          "type": "keyword"
        },
        "outer_vlan": {
          "ignore_above": 1024,
          "type": "keyword"
        },
        "params": {
          "norms": false,
          "type": "text"
        },
        "path": {
          "ignore_above": 1024,
          "type": "keyword"
        },
        "port": {
          "ignore_above": 1024,
          "type": "keyword"
        },
        "proc": {
          "ignore_above": 1024,
          "type": "keyword"
        },
        "query": {
          "ignore_above": 1024,
          "type": "keyword"
        },
        "real_ip": {
          "ignore_above": 1024,
          "type": "keyword"
        },
        "release": {
          "ignore_above": 1024,
          "type": "keyword"
        },
        "request": {
          "norms": false,
          "type": "text"
        },
        "resource": {
          "ignore_above": 1024,
          "type": "keyword"
        },
        "response": {
          "norms": false,
          "type": "text"
        },
        "responsetime": {
          "type": "long"
        },
        "rpc": {
          "properties": {
            "auth_flavor": {
              "ignore_above": 1024,
              "type": "keyword"
            },
            "call_size": {
              "type": "long"
            },
            "cred": {
              "properties": {
                "gid": {
                  "type": "long"
                },
                "gids": {
                  "ignore_above": 1024,
                  "type": "keyword"
                },
                "machinename": {
                  "ignore_above": 1024,
                  "type": "keyword"
                },
                "stamp": {
                  "type": "long"
                },
                "uid": {
                  "type": "long"
                }
              }
            },
            "reply_size": {
              "type": "long"
            },
            "status": {
              "ignore_above": 1024,
              "type": "keyword"
            },
            "time": {
              "type": "long"
            },
            "time_str": {
              "ignore_above": 1024,
              "type": "keyword"
            },
            "xid": {
              "ignore_above": 1024,
              "type": "keyword"
            }
          }
        },
        "server": {
          "ignore_above": 1024,
          "type": "keyword"
        },
        "service": {
          "ignore_above": 1024,
          "type": "keyword"
        },
        "source": {
          "properties": {
            "ip": {
              "ignore_above": 1024,
              "type": "keyword"
            },
            "ip_location": {
              "type": "geo_point"
            },
            "ipv6": {
              "ignore_above": 1024,
              "type": "keyword"
            },
            "ipv6_location": {
              "type": "geo_point"
            },
            "mac": {
              "ignore_above": 1024,
              "type": "keyword"
            },
            "outer_ip": {
              "ignore_above": 1024,
              "type": "keyword"
            },
            "outer_ip_location": {
              "type": "geo_point"
            },
            "outer_ipv6": {
              "ignore_above": 1024,
              "type": "keyword"
            },
            "outer_ipv6_location": {
              "type": "geo_point"
            },
            "port": {
              "ignore_above": 1024,
              "type": "keyword"
            },
            "stats": {
              "properties": {
                "net_bytes_total": {
                  "type": "long"
                },
                "net_packets_total": {
                  "type": "long"
                }
              }
            }
          }
        },
        "start_time": {
          "type": "date"
        },
        "status": {
          "ignore_above": 1024,
          "type": "keyword"
        },
        "tags": {
          "ignore_above": 1024,
          "type": "keyword"
        },
        "thrift": {
          "properties": {
            "exceptions": {
              "ignore_above": 1024,
              "type": "keyword"
            },
            "params": {
              "ignore_above": 1024,
              "type": "keyword"
            },
            "return_value": {
              "ignore_above": 1024,
              "type": "keyword"
            },
            "service": {
              "ignore_above": 1024,
              "type": "keyword"
            }
          }
        },
        "transport": {
          "ignore_above": 1024,
          "type": "keyword"
        },
        "type": {
          "ignore_above": 1024,
          "type": "keyword"
        },
        "vlan": {
          "ignore_above": 1024,
          "type": "keyword"
        }
      }
    }
  },
  "order": 0,
  "settings": {
    "index.mapping.total_fields.limit": 10000,
    "index.refresh_interval": "5s"
  },
  "template": "packetbeat-*"
}
